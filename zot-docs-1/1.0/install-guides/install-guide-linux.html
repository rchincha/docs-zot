<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Installing zot on Bare Metal Linux :: Zot Docs</title>
    <meta name="generator" content="Antora 3.0.1">
    <link rel="stylesheet" href="../../../_/css/site.css">
    <script>var uiRootPath = '../../../_'</script>
    <link rel="icon" href="../../../favicon.ico" type="image/x-icon">  </head>
  <body class="article">
<header class="header">
  <nav class="navbar">
    <div class="navbar-brand">
      <a class="navbar-item navbar-logo" href="../../.."></a>
      <a class="navbar-item" href="../../..">Zot Docs</a>
      <button class="navbar-burger" data-target="topbar-nav">
        <span></span>
        <span></span>
        <span></span>
      </button>
    </div>
    <div id="topbar-nav" class="navbar-menu">
      <div class="navbar-end">
        <a class="navbar-item" href="https://zotregistry.io/">Home</a>
      </div>
    </div>
  </nav>
</header>
<div class="body">
<div class="nav-container" data-component="zot-docs-1" data-version="1.0">
  <aside class="nav">
    <div class="panels">
<div class="nav-panel-menu is-active" data-panel="menu">
  <nav class="nav-menu">
    <h3 class="title"><a href="../toc/zot-toc.html">Zot Documentation</a></h3>
<ul class="nav-list">
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../toc/zot-toc.html">Documentation</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">General</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../general/zot-concepts.html">Concepts</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../general/artifacts.html">Released Artifacts for zot</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">User Guides</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../user-guides/user-guide-datapath.html">Push and Pull Image Content</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../admin-guide/admin-guide.html">Zot Administrator Guide</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../developer-guide/developer-guide.html">Zot Developer Guide</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Installation Guides</span>
<ul class="nav-list">
  <li class="nav-item is-current-page" data-depth="2">
    <a class="nav-link" href="install-guide-linux.html">Installing zot on Bare Metal Linux</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="install-guide-k8s.html">Installing zot with Kubernetes and Helm</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Articles</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../kb/building-ci-cd-pipeline.html">Building an OCI-native Container Image CI/CD Pipeline</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../kb/authn-authz.html">User Authentication and Authorization with zot</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../kb/security-posture.html">zot Security Posture</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../kb/storage.html">Storage Planning with zot</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../kb/clustering.html">zot Clustering</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../kb/benchmarking-with-zb.html">Benchmarking zot with zb</a>
  </li>
</ul>
  </li>
</ul>
  </li>
</ul>
  </nav>
</div>
<div class="nav-panel-explore" data-panel="explore">
  <div class="context">
    <span class="title">Zot Documentation</span>
    <span class="version">1.0</span>
  </div>
  <ul class="components">
    <li class="component is-current">
      <a class="title" href="../toc/zot-toc.html">Zot Documentation</a>
      <ul class="versions">
        <li class="version is-current is-latest">
          <a href="../toc/zot-toc.html">1.0</a>
        </li>
      </ul>
    </li>
  </ul>
</div>
    </div>
  </aside>
</div>
<main class="article">
<div class="toolbar" role="navigation">
<button class="nav-toggle"></button>
  <a href="../toc/zot-toc.html" class="home-link"></a>
<nav class="breadcrumbs" aria-label="breadcrumbs">
  <ul>
    <li><a href="../toc/zot-toc.html">Zot Documentation</a></li>
    <li>Installation Guides</li>
    <li><a href="install-guide-linux.html">Installing zot on Bare Metal Linux</a></li>
  </ul>
</nav>
</div>
  <div class="content">
<aside class="toc sidebar" data-title="Contents" data-levels="2">
  <div class="toc-menu"></div>
</aside>
<article class="doc">
<h1 class="page">Installing zot on Bare Metal Linux</h1>
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>Revised: 2022-08-09</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_before_you_begin"><a class="anchor" href="#_before_you_begin"></a><a class="link" href="#_before_you_begin">Before you begin</a></h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_about_binary_images"><a class="anchor" href="#_about_binary_images"></a><a class="link" href="#_about_binary_images">About binary images</a></h3>
<div class="paragraph">
<p>Executable binary zot images are available for multiple platforms and
architectures and with full or minimal implementations.</p>
</div>
<div class="paragraph">
<p>Refer to <a href="../general/artifacts.html" class="xref page"><em>Released Artifacts for zot</em></a>
for information about available zot images along with information about
image variations, image locations, and image naming formats.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_installation"><a class="anchor" href="#_installation"></a><a class="link" href="#_installation">Installation</a></h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_step_1_get_zot"><a class="anchor" href="#_step_1_get_zot"></a><a class="link" href="#_step_1_get_zot">Step 1: Get zot</a></h3>
<div class="paragraph">
<p>Using <code>wget,</code> download the appropriate zot binary image for your platform from the
<a href="https://github.com/project-zot/zot/releases">zot GitHub project</a>. Download the image
to the`/usr/bin/` directory and rename it to <code>zot,</code> as in this example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ wget -O /usr/bin/zot  https://github.com/project-zot/zot/releases/download/v1.4.2-rc2/zot-linux-amd64</pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_step_2_create_a_zot_configuration_file"><a class="anchor" href="#_step_2_create_a_zot_configuration_file"></a><a class="link" href="#_step_2_create_a_zot_configuration_file">Step 2: Create a zot configuration file</a></h3>
<div class="paragraph">
<p>Create a zot configuration file as <code>/etc/zot/config.json</code>.</p>
</div>
<div class="paragraph">
<p>See <a href="#config_file">Configuration file options</a> for an example file with
options and recommendations. You can find other configuration file
<a href="https://github.com/project-zot/zot/tree/main/examples">examples</a> in
the zot GitHub project and in the
<a href="../admin-guide/admin-guide.html" class="xref page"><em>Zot Administrator Guide</em></a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="_step_3_configure_a_local_authentication_account"><a class="anchor" href="#_step_3_configure_a_local_authentication_account"></a><a class="link" href="#_step_3_configure_a_local_authentication_account">Step 3: Configure a local authentication account</a></h3>
<div class="paragraph">
<p>If you want to use local authentication with zot, create a <code>/etc/zot/htpasswd</code>
file with an initial account entry using the <code>htpasswd</code> command as in this
example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ htpasswd -bnB myUserName myPassword &gt; /etc/zot/htpasswd</pre>
</div>
</div>
<div class="paragraph">
<p>To add additional local users, use the <code>&gt;&gt;</code> redirect as in this example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ htpasswd -bnB myUserName2 myPassword2 &gt;&gt; /etc/zot/htpasswd</pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_step_4_define_the_zot_service"><a class="anchor" href="#_step_4_define_the_zot_service"></a><a class="link" href="#_step_4_define_the_zot_service">Step 4: Define the zot service</a></h3>
<div class="paragraph">
<p>Create a <code>/etc/systemd/system/zot.service</code> file to define the zot service
in systemd.  The following is an example service file for zot:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>[Unit]
Description=OCI Distribution Registry
Documentation=https://zotregistry.io/
After=network.target auditd.service local-fs.target

[Service]
Type=simple
ExecStart=/usr/bin/zot serve /etc/zot/config.json
Restart=on-failure
User=zot
Group=zot
LimitNOFILE=500000
MemoryHigh=30G
MemoryMax=32G

[Install]
WantedBy=multi-user.target</pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Be sure to configure a dedicated non-root user ID as the User and Group in
the zot service definition. The 'zot' user ID in this example is created in the
next step.
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_step_5_create_a_user_id_to_own_the_zot_service"><a class="anchor" href="#_step_5_create_a_user_id_to_own_the_zot_service"></a><a class="link" href="#_step_5_create_a_user_id_to_own_the_zot_service">Step 5: Create a user ID to own the zot service</a></h3>
<div class="paragraph">
<p>Create a non-root user ID to be the owner of the zot service and its resources.</p>
</div>
<div class="paragraph">
<p>In this example, the user ID 'zot' is created with the <code>adduser</code> command, and
resource ownership is assigned.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ sudo adduser --no-create-home --disabled-password --gecos --disabled-login zot

$ sudo mkdir -p /data/zot
$ sudo chown -R zot:zot /data/zot

$ sudo mkdir -p /var/log/zot
$ sudo chown -R zot:zot /var/log/zot

$ sudo chown root:root /usr/bin/zot
$ sudo chown root:root config.json</pre>
</div>
</div>
<div class="paragraph">
<p>With the <code>adduser</code> options shown, the 'zot' user ID has no local directory.
There is no ability to log into the zot user account, and the account has
no finger information.</p>
</div>
</div>
<div class="sect2">
<h3 id="_step_6_start_zot"><a class="anchor" href="#_step_6_start_zot"></a><a class="link" href="#_step_6_start_zot">Step 6: Start zot</a></h3>
<div class="paragraph">
<p>Enable and start the zot service with these commands:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ sudo systemctl enable zot
$ sudo systemctl start zot</pre>
</div>
</div>
<div class="paragraph">
<p>When the zot service has started, you can check its status with this command:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ sudo systemctl status zot</pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_after_the_installation"><a class="anchor" href="#_after_the_installation"></a><a class="link" href="#_after_the_installation">After the installation</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>If your zot registry server is public facing, we recommend that you test
your TLS configuration using a service such as
the <a href="https://www.ssllabs.com/ssltest/">Qualys SSL Server Test</a>.</p>
</div>
<div class="paragraph">
<p>Refer to the <a href="../admin-guide/admin-guide.html" class="xref page"><em>Zot Administrator Guide</em></a>
for further information about maintaining your
zot registry server.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="config_file"><a class="anchor" href="#config_file"></a><a class="link" href="#config_file">Configuration file options and recommendations</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>The following zot configuration file (<code>config.json</code>) can be used as a template
for your own installation. You can modify this file to suit your own environment.</p>
</div>
<div class="paragraph">
<p>Refer to the <a href="../admin-guide/admin-guide.html" class="xref page"><em>Zot Administrator Guide</em></a>
for more details about configuration file options.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json hljs" data-lang="json">{
  "distSpecVersion":"1.0.1",
  "storage":{
    "dedupe": true,
    "gc": true,
    "gcDelay": "1h",
    "gcInterval": "6h",
    "rootDirectory":"/data/zot/"
  },
  "http": {
    "address":"0.0.0.0",
    "port":"443",
    "realm":"zot",
    "tls": {
      "cert": "/etc/letsencrypt/live/zothub.io/fullchain.pem",
      "key": "/etc/letsencrypt/live/zothub.io/privkey.pem"
    },
    "auth": {
      "htpasswd": {
        "path": "/etc/zot/htpasswd"
      },
      "failDelay": 5
    },
    "allowReadAccess": true
  },
  "log":{
    "level":"debug",
    "output":"/var/log/zot/zot.log",
    "audit":"/var/log/zot/zot-audit.log"
  },
  "extensions": {
    "search": {
      "enable": true,
      "cve": {
        "updateInterval": "24h"
      }
    },
    "sync": {
      "enable": false,
      "registries": [
        {
          "urls": ["https://mirror.gcr.io/library"],
          "onDemand": true,
          "maxRetries": 3,
          "retryDelay": "5m",
          "pollInterval": "6h"
        },
        {
          "urls": ["https://docker.io/library"],
          "onDemand": true
        }
      ]
    },
    "scrub": {
      "interval": "24h"
    }
  }
}</code></pre>
</div>
</div>
<div class="sect2">
<h3 id="_tls_encryption"><a class="anchor" href="#_tls_encryption"></a><a class="link" href="#_tls_encryption">TLS encryption</a></h3>
<div class="paragraph">
<p>We recommend using a certificate authority such as
<a href="https://letsencrypt.org/">Let&#8217;s Encrypt</a> that offers TLS encryption, as
shown in this configuration example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json hljs" data-lang="json">"tls": {
  "cert": "/etc/letsencrypt/live/zothub.io/fullchain.pem",
  "key": "/etc/letsencrypt/live/zothub.io/privkey.pem"
}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_registry_synchronization"><a class="anchor" href="#_registry_synchronization"></a><a class="link" href="#_registry_synchronization">Registry synchronization</a></h3>
<div class="paragraph">
<p>The example file enables registry synchronization with two other container
registries. In the example, the zot server synchronizes with the Google
and Docker container registries, as shown here:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json hljs" data-lang="json">"sync": {
  "enable": false,
  "registries": [
    {
      "urls": ["https://mirror.gcr.io/library"],
      "onDemand": true,
      "maxRetries": 3,
      "retryDelay": "5m",
      "pollInterval": "6h"
    },
    {
      "urls": ["https://docker.io/library"],
      "onDemand": true
    }
  ]
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</article>
  </div>
</main>
</div>
<footer class="footer">
</footer>
<script id="site-script" src="../../../_/js/site.js" data-ui-root-path="../../../_"></script>
<script async src="../../../_/js/vendor/highlight.js"></script>
  </body>
</html>
